{% extends "base.html" %}
{% block content %}
<h1>Einstellungen</h1>
<form method="post">
  <label>Projektname <input name="project_name" value="{{ cfg.project_name }}"></label>
  <label>Projektordner ausw√§hlen</label>
    <input type="file" id="folderPicker" webkitdirectory directory multiple>
    <input type="hidden" name="project_path" id="projectPath" value="{{ cfg.project_path }}">

    <script>
      document.getElementById("folderPicker").addEventListener("change", (evt) => {
        if (evt.target.files.length > 0) {
          // erstes File nehmen, Pfad davon extrahieren
          const first = evt.target.files[0];
          // Browser gibt nur relativen Fake-Pfad, daher: wir nehmen das Verzeichnis vom filename
          let pathParts = first.webkitRelativePath.split("/");
          pathParts.pop(); // Datei entfernen
          const folderPath = "/" + pathParts.join("/");
          document.getElementById("projectPath").value = folderPath;
        }
      });
    </script>
  <label>Branch <input name="branch" value="{{ cfg.branch }}"></label>
  <label>Remote URL <input name="remote_url" value="{{ cfg.remote_url }}" placeholder="https://github.com/user/repo.git"></label>
  <label>WIP-Branch (optional) <input name="wip_branch" value="{{ cfg.wip_branch }}"></label>
  <div class="row">
    <label><input type="checkbox" name="auto_commit" {% if cfg.auto_commit %}checked{% endif %}> Auto-Commit</label>
    <label><input type="checkbox" name="auto_push" {% if cfg.auto_push %}checked{% endif %}> Auto-Push</label>
  </div>
  <div class="row">
    <label>Batch-Fenster (Sek.) <input name="batch_window_sec" type="number" min="1" value="{{ cfg.batch_window_sec }}"></label>
    <label>Debounce (ms) <input name="debounce_ms" type="number" min="0" value="{{ cfg.debounce_ms }}"></label>
    <label>Max. Backups/Datei <input name="max_backups" type="number" min="0" value="{{ cfg.max_backups }}"></label>
  </div>
  <button>Speichern</button>
</form>
{% endblock %}
